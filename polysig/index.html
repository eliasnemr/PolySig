<!DOCTYPE html>
<!-- PolySig, Version 1.0 -->
<!-- Created by Elias Nemr -->
<!-- Minima, Global -->
<!-- github.com/eliasnemr -->
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title></title>
        <base href=".">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="css/styles.css">
        <link rel="stylesheet" href="css/custom.css">
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    </head>
    <body>
        <script>
            $(document).ready(function() {

                //$('.carousel').carousel();

                Minima.init(function(msg){
                    if (msg.event == "connected") {
                        const TABLE = 'CREATE TABLE IF NOT EXISTS CONTRACTS (id int NOT NULL, address VARCHAR(160), timestamp VARCHAR(160), keys VARCHAR(160) NOT NULL, users VARCHAR(160) NOT NULL, type VARCHAR(160) NOT NULL);SELECT * FROM CONTRACTS';
                        Minima.sql(TABLE, function(res){
                            if (res.status) {
                                // console.log('Created Contracts SQL Table');
                            }
                        });
                    }
                });
            });
        </script>
        <script>
            // Transitions
            document.addEventListener("DOMContentLoaded", function(){

                let txnID = "";
                let inp = 1;
                let input = {id: "", signees: "", min: "", users: [], keys: [], inputs: [], total: 0}; 
                let output = {amount: 0, address: "", tokenid: "", keys: { id: [], proof: ""} };

                const menu = document.getElementById("start-menu-title");
                const help = document.getElementById("help-menu-title");
                const createBtn = document.getElementById("btnWrap1");
                const provideBtn = document.getElementById("btnWrap2");
                const helpBtn = document.getElementById("helpBtn");
                const helpDiv = document.getElementById("help");

                $('#tutorialBtn').on('click', function() {
                    $('#tutorial').addClass('hide');
                    // set seen as true, add to Minima.file..
                });
                $('#tutorialClose3').on('click', function(){
                    $('#tutorial').addClass('hide');
                });
                $('#tutorialClose2').on('click', function(){
                    $('#tutorial').addClass('hide');
                });
                $('#tutorialClose').on('click', function(){
                    $('#tutorial').addClass('hide');
                });
                $('#carouselNext1').on('click', function(){
                    $('.carousel.carousel-slider').carousel('next');
                });

                $('#homeBtn').on('click', function(){
                    setTimeout(() => {
                        menu.classList.add("scale-in");
                        createBtn.classList.add("scale-in");
                        provideBtn.classList.add("scale-in");

                        $('#s-menu').css("display", "block");
                        $('#s-help').css("display", "none");

                    }, 150);

                });
                $('#homeBtn2').on('click', function(){
                    setTimeout(() => {
                        menu.classList.add("scale-in");
                        createBtn.classList.add("scale-in");
                        provideBtn.classList.add("scale-in");

                        $('#s-menu').css("display", "block");
                        $('#s-create').css("display", "none");

                    }, 150);

                });
                $('#homeBtn3').on('click', function(){
                    // reset... 
                    input.users = [];
                    input.keys = [];
                    $('#s-create').css('display', 'block');
                    $('#s-stage1').addClass('hide');

                });
                $('#homeBtn4').on('click', function(){

                    if(!$('#continueBtnWrapper').hasClass('hide')) {
                        $('#continueBtnWrapper').addClass('hide');
                    }

                    if(!$('#postContractWrapper').hasClass('hide')) {
                        $('#postContractWrapper').addClass('hide');
                    }

                    $('#s-stage1-2').addClass('hide');
                    $('#s-stage1').removeClass('hide');
                });
                $('#homeBtn5').on('click', function(){
                    $('#s-contracts').addClass('hide');
                    $('#s-menu').css('display', 'block');
                });
                $('#createBtn').on('click', function(){

                    setTimeout(() => {
                        menu.classList.add("scale-out");
                        createBtn.classList.add("scale-out");
                        provideBtn.classList.add("scale-out");


                        $('#s-menu').css("display", "none");
                        $('#s-create').css("display", "block");

                    }, 75);
                    

                });

                function m_exportFunction() {
                    var html = `<ul class="coll-tip1 collection with-header">
                        <li class="collection-header"><h4>Tip #1 &mdash; Inputs</h4></li>
                        <li class="collection-item">To obtain your partner's coins use these functions in your MINI terminal</li>
                        <li class="collection-item">&mdash; <a onclick="m_exportFunction()" href=''>exportcoin</a> <span id="descr">[coinid] - export the proof of a single coin. Share it.</span></li>
                        <li class="collection-item">&mdash; <a href=''>importcoin</a> <span id="descr">[data] - Import the proof of a coin.</span></li>
                        <li class="collection-item">&mdash; <a href=''>keepcoin</a>  <span id="descr">[coinid] - Add a coin to the list of coins you keep track of. MUST be a recent coin in the current blocks.</span></li>
                    </ul>`;
                    $('#s-tip1 > #coll-tip1').remove();

                }
                function copyText(id) {

                    var str = document.getElementById(id).value;

                    const el = document.createElement('textarea');
                    el.value = str;
                    document.body.appendChild(el);
                    el.select();
                    document.execCommand('copy');
                    document.body.removeChild(el);

                    /* Alert the copied text */
                    M.toast({html: "Copied to clipboard.", classes: "success"});

                }
                function copyBase64(data) {

                    const el = document.createElement('textarea');
                    el.value = data;
                    document.body.appendChild(el);
                    el.select();
                    document.execCommand('copy');
                    document.body.removeChild(el);

                    M.toast({html: "Copied Package to Clipboard", classes: "success"});
                    
                }
                
                $('#proceedBtn').on('click', function(){
                    // reset
                    input.signees = 0;
                    input.min = 0;

                    $('#participants > ul:last-child').empty();
                    let confirmed = false;
                    var users = $('#users').val();
                    users = parseInt(users);
                    var minimum = $('#minimum').val();
                    minimum = parseInt(minimum);

                    $('#modalCreate').modal({
                        dismissible: false,
                        opacity: 0.2,
                        onOpenStart: function() {

                            $('#confirm').on('click', function(){
                                confirmed = true;
                            });

                            if(users >= 2 &&  minimum <= users) {
                                $('#confirm').removeClass('hide');
                                $('#m-contractHeader').text('Continue?');
                                $('#m-contractHeader').css("color", "rgb(86,138,119)");
                                $('#m-contractType').text('This is a ' + minimum +'/'+ users + " multi-signature contract.");
                            } else {
                                $('#confirm').addClass('hide');
                                $('#m-contractHeader').text('Invalid Contract.');
                                $('#m-contractHeader').css("color", "rgb(173,74,83)");
                                $('#m-contractType').text("You need at least 2 Signees and less than or equal amounts of minimum signatures to unlock this contract.");
                            }

                        },
                        onCloseEnd: function() {
                            if(confirmed) {
                                // empty on leave...   
                                $('#users').val("");
                                $('#minimum').val("");

                                input.signees = users;
                                input.min = minimum;
                                let json = JSON.stringify(input);
                                Minima.file.save(json, "inputs.txt", function(res){
                                    if (res.success) {
                                        $('#s-create').css("display", "none");
                                        $('#s-stage1').removeClass('hide');

                                        for (let i = 0; i < input.signees; i++) {

                                            let markup = 
                                                    '<li class="collection-item user-item">'+
                                                        '<div class="card blue-grey darken-1">'+
                                                            '<div class="card-image">'+
                                                                '<i class="material-icons">portrait</i>'+
                                                            '</div>'+
                                                            '<div class="card-content">'+
                                                                '<div class="input-field">'+
                                                                    '<input id="name'+i+'" type="text"/>'+
                                                                    '<label for="name'+i+'">Name</label>'+
                                                                '</div>'+
                                                                '<div class="input-field">'+
                                                                    '<input id="key'+i+'" type="text"/>'+
                                                                    '<label for="key'+i+'">Public key</label>'+
                                                                '</div>'+
                                                            '</div>'+
                                                        '</div>'+
                                                    '</li>';
                                            $('#participants > ul:last-child').append(markup);
                                        }

                                    } else {
                                        alert("Minima is offline...");
                                    }
                                });
                            }
                        }
                    }); 
                });
                $('#proceedBtnStage1').on('click', function(){
                    // reset
                    input.users = [];
                    input.keys = [];

                    if(!$('#copyPackageWrapper').hasClass('hide')) {
                        $('#copyPackageWrapper').addClass('hide');
                    }

                    // declaring temporary Arrays
                    let idArr = [];
                    let valueArr = [];

                    $('#participants ul').find('li input[type="text"]').each(function() {
                        if($(this)[0].id.substring(0,4) == "name"){
                            input.users.push($(this)[0].value);
                        } else if($(this)[0].id.substring(0,3) == "key") {
                            input.keys.push($(this)[0].value);
                        }
                        
                    });

                    let json = JSON.stringify(input);
                    Minima.file.save(json, "inputs.txt", function(res){
                        if(res.success) { 
                            $('#participants ul').find('li input[type="text"]').each(function() {
                                // clear inputs
                                $(this)[0].value = "";  
                            });

                            $('#s-stage1').addClass('hide');
                            $('#s-stage1-2').removeClass('hide');

                            if($('#multiSigScript').length > 0) {
                                $('#multiSigScript > :last-child').remove();
                            }

                            Minima.file.load("inputs.txt", function(file){
                                if(file.success) {
                                    const keys = JSON.parse(file.data);
                                    let script = "";
                                    let allKeys = "";
                                    input.keys.forEach((id, i) => {
                                        if(input.keys.length == i+1) {
                                            allKeys += id;
                                        } else {
                                            allKeys += id + " ";
                                        }
                                    });
                                    script = "RETURN MULTISIG("+input.min+" "+allKeys+")";
                                    
                                    Minima.cmd('newscript "'+script+'"', function(res){
                                        if(res.status) {
                                            const markup = 
                                            "<div class='row'>"+
                                                "<div class='col s12'>"+
                                                    "<div id='scriptWrapper'>"+
                                                        "<div>"+
                                                            "<p>"+script+"</p>"+
                                                            "<i class='material-icons'>arrow_forward</i>"+
                                                            "<input id='proofAddress' class='center-align' disabled value='"+res.response.address.hexaddress+"'/>"+
                                                        "</div>"+
                                                    "</div>"+
                                                "</div>"+
                                            "</div>";
                                            
                                            $('#copyPackageWrapper').removeClass('hide');
                                           
                                            $('#multiSigScript').append(markup);
                                            output.proof = res.response.address.hexaddress;
                                            let json = JSON.stringify(output);
                                            Minima.file.save(json, "output.txt", function(){});
                                        }
                                    });
                                    

                                }

                            });
                        }
                    });

                    

                });
                $(document).on('click', "#copyAddress", function(){
                    input.id = 0;
                    // Create random ID
                    const id = Math.floor(Math.random()*1000000000);
                    input.id = id;
                    // creating json package
                    let data = {
                        id: id,
                        type: "",
                        message: "",
                        keys: [],
                        users: [],
                        hexaddress: "",
                    }

                    // set the json package.
                    data.type = "toScript";
                    data.message = "You are about to save a new script address in your script address";
                    data.keys = input.keys;
                    data.users = input.users;
                    data.hexaddress = output.proof;
                    // stringify the json package.
                    data = JSON.stringify(data);
                    // convert to base64.
                    data = btoa(data);
                    // copy to clipboard.
                    copyBase64(data);
                    // Display Script
                    $('#multiSigScript > :last-child').remove();

                    $('#copyPackageWrapper').addClass('hide');
                    $('#continueBtnWrapper').removeClass('hide');

                    let markup = 
                            '<div class="row">'+
                                '<div class="col s12">'+
                                    '<div id="toSendWrapper">'+
                                        '<div>'+
                                            '<p>How much Minima would you like to spend in this contract?</p>'+
                                            '<div class="input-field">'+
                                                '<input id="toSend" type="number"/>'+
                                                '<label for="toSend">Total amount to spend</label>'+
                                            '</div>'+
                                        '</div>'+
                                    '</div>'+
                                '</div>'+
                            '</div>';

                    $('#multiSigScript').append(markup);

                    // Change title
                    const title = '<i id="info" class="tiny material-icons" style="margin: 0;">info</i> Now that all your participant(s) are tracking this contract, let us continue...';
            
                    $('#s-stage1-2 #create-menu-title h1').html(title);
                    
                });
                $(document).on('click', '#endStageBtn1', function(){

                    // amount user wants to spend
                    let amnt = 0;

                    // signees
                    let signee = "";

                    // amount to send
                    amnt = $('#toSend').val();
                    // id
                    let id = input.id;

                    let json = JSON.stringify(input);
                    Minima.file.save(json, 'inputs.txt', function(){});

                    
                    // Create and post transaction
                    const txn = 'txncreate '+id+';'+
                                "txnstate "+id+" "+125+" "+input.signees+';'+
                                "txnstate "+id+" "+126+" "+input.min+';'+
                                'txnauto '+id+' '+amnt+' '+output.proof+' '+'0x00';
                              

                    input.keys.forEach((key, i) => {
                        signee += 
                        '<li class="collection-item contract-item"><div>Signee #'+i+'&mdash;'+input.users[i]+'</div><a id="users" class="secondary-content">'+key+'</a></li>';
                    });

                    
                              
                    // Create Transaction...
                    Minima.cmd(txn, function(res) {
                        // check all responses..
                        if (Minima.util.checkAllResponses(res)) {
                            // Change title
                            const title = '<i id="info" class="tiny material-icons" style="margin: 0;">info</i> This is your contract.  Post when ready!';            
                            $('#s-stage1-2 #create-menu-title h1').html(title);

                            // show Btn
                            $('#postContractWrapper').removeClass('hide');
                            // hide this btn
                            $('#continueBtnWrapper').addClass('hide');
                            
                            M.toast({html: "Completed Contract...", classes:"success"});

                            $('#multiSigScript > :last-child').remove();

                            $('#s-stage1-2 > .row .col #titles').html("Your <span id='brand' style='width: 30px;'>Polysig</span> Contract");

                            let markup =
                                    '<div class="row">'+
                                        '<div class="col s12">'+
                                            '<div class="card contract-card">'+
                                                '<div class="card-image">'+
                                                    '<span class="card-title contractId">#'+id+'</span>'+'<br>'+
                                                '</div>'+
                                                '<div class="card-content">'+
                                                    '<div class="contract-amnt">'+
                                                        '<h4>'+
                                                            amnt+
                                                        '</h4>'+
                                                        '<p>This is the total amount you are using in your contract.</p>'+
                                                    '</div>'+
                                                    '<ul class="collection">'+
                                                        '<li class="collection-item"><div>Participating Users</div><a id="users" class="secondary-content">'+input.users+'</a></li>'+
                                                        '<li class="collection-item"><div>Minimum required signee(s)</div><a id="users" class="secondary-content">'+input.min+'</a></li>'+
                                                    '</ul>'+
                                                    '<ul class="collection with-header collection-keys">'+
                                                        '<li class="collection-header contract-header">Signee(s)</li>'+
                                                        signee+
                                                    '</ul>'+
                                                '</div>'+
                                            '</div>'+
                                        '</div>'+
                                    '</div>';
                            $('#multiSigScript').append(markup);


                        } else {
                            M.toast({html: "Transaction failed to post..."});
                        }

                    });

                });
                $('#postBtn').on('click', function() {
                    // remove contract
                    $('#multiSigScript > :last-child').remove();
                    // hide btn
                    $('#postContractWrapper').addClass('hide');
                    // hide section
                    $('#s-stage1-2').addClass('hide');
                    // show main menu 
                    $('#s-menu').css('display', 'block');

                    Minima.file.load("inputs.txt", function(res){
                        if (res.success) {

                            var data = JSON.parse(res.data);

                            Minima.cmd('txnpost '+ data.id, function(resp){
                                if (resp.status) {
                                    M.toast({html: 'Success! Contract posted!', classes: 'success'});

                                    const INSERT = "INSERT INTO CONTRACTS VALUES ('";
                                    Minima.cmd('txnlist ' + input.id, function(respo) {
                                        if (respo.status) {
                                            let users = JSON.stringify(input.users);
                                            let keys = JSON.stringify(input.keys);
                                            let date = Date.now().toString();
                                            let type = "This is a "+input.min+"/"+input.signees+" MultiSig Contract";
                                            Minima.sql(INSERT+input.id+"', '"+output.proof+"', '"+date+"', '"+keys+"', '"+users+"', '"+type+"')", function(response){
                                                if (response.status) {
                                                    Minima.cmd('txndelete '+input.id, function(){});
                                                }
                                            });
                                }
                                
                            });

                                }
                            })
                            

                        }
                    }); 
                });

                /** Contracts Functionalities */
                $('#provideBtn').on('click', function() {
                    $('#s-menu').css("display", "none");
                    $('#s-contracts').removeClass("hide");

                    $('#contract').empty();

                    Minima.sql("SELECT * FROM CONTRACTS", function(res){
                        //console.log(res);
                        if (res.status && res.response.rows.length > 0) {
                            $('#contracts > ul > .collection-header').html('Contracts <div id="dd-editBtn" style="float:right;" class="dropdown-trigger btn-flat" data-target="dd-edit">Edit</div>');
                            $('#contracts > ul > .collection-header').css("color", "rgb(188,192,194)");
                            $('#contracts > ul > .collection-header').css("font-size", "1.5rem");
                            // retrieve data and fill activities
                            res.response.rows.forEach((row, i) => {
                                
                                let markup = 
                                            '<li class="collection-item hideDeleteForever">'+
                                                '<div id="'+row.ID+'" class="card blue-grey darken-1">'+
                                                    '<div class="card-content white-text">'+
                                                        '<span class="card-title"><span id="brand">#</span>'+row.ID+'</span>'+
                                                        '<span id="deleteForever" href="#dd-editModal" class="right modal-trigger"><i style="color: rgb(0,0,0); cursor: pointer;" class="material-icons">delete</i></span>'+
                                                        '<p id="contractType">'+row.TYPE+'</p>'+
                                                        '<p id="timestamp">'+ moment(parseInt(row.TIMESTAMP)).format("MMMM Do YYYY &#8212; HH:mm:ss a") +'</p>'+
                                                    '</div>'+
                                                    '<div class="card-action">'+
                                                        '<a id="'+row.ID+'" class="viewContract">View Contract</a>'+
                                                    '</div>'+
                                                '</div>'+
                                            '</li>';
                                $('#contract').append(markup);
                                
                            });


                        } else {
                            $('#contracts > ul > .collection-header').text("No contracts found!");
                            $('#contracts > ul > .collection-header').css("color", "#736AB6");
                            $('#contracts > ul > .collection-header').css("font-weight", "800");

                        }

                    });
                    
                    
                   

                });
                $(document).on('click', '.viewContract', function(){

                    let id = $(this).attr('id');
                    // Show details of this txnlist..
                    Minima.sql('SELECT * FROM CONTRACTS WHERE ID='+id, function(res){
                        console.log(res);
                        if (res.status && res.response.rows.length > 0) {
                            $('#contract').addClass('hide');
                            $('#contract-details').removeClass('hide');

                            let row = res.response.rows[0];
                            let users = JSON.parse(row.USERS);
                            let signees = JSON.parse(row.KEYS);
                            let signee = "";

                            signees.forEach((key, i) => {
                                signee += 
                                '<li class="collection-item contract-item"><div>Signee #'+i+'&mdash;'+users[i]+'</div><a id="users" class="secondary-content">'+key+'</a></li>';
                            });

                            Minima.cmd('coins relevant address:'+row.ADDRESS, function(res) {

                                if (res.status && res.response.coins.length > 0){
                                    let coin = res.response.coins[0].data;
                                    
                                    let markup = 
                                            '<li class="collection-item contract">'+
                                                '<div class="card contract-card">'+
                                                    '<div class="card-image">'+
                                                        '<span class="card-title contractId">#'+row.ID+'</span>'+'<br>'+
                                                    '</div>'+
                                                    '<div class="card-content">'+
                                                        '<span class="backContract"> <i class="material-icons">chevron_left</i></span>'+
                                                        '<p id="contractType">'+row.TYPE+'</p>'+
                                                        '<p id="timestamp">'+ moment(parseInt(row.TIMESTAMP)).format("MMMM Do YYYY &#8212; HH:mm:ss a") +'</p>'+
                                                        '<hr>'+
                                                        '<div class="row details">'+
                                                            '<div class="col s12">'+
                                                                '<ul class="collection with header">'+
                                                                    '<li class="collection-header"> Details </li>'+
                                                                    '<li class="collection-item"><div> PARTICIPATING USERS </div> <a class="secondary-content">'+users+'</a> </li>'+
                                                                    '<li class="collection-item"><div> Available Spend </div> <a class="secondary-content">'+coin.coin.amount+'</a> </li>'+
                                                                    '<li class="collection-item"><div> Is Spent </div> <a class="secondary-content">'+coin.spent+'</a> </li>'+
                                                                    '<li class="collection-item"><div> Script Address </div> <a class="secondary-content">'+coin.coin.address+'</a> </li>'+
                                                                '</ul>'+
                                                                '<ul class="collection with-header collection-keys">'+
                                                                    '<li class="collection-header contract-header">Signee(s)</li>'+
                                                                    signee+
                                                                '</ul>'+
                                                            '</div>'+
                                                        '</div>'+                                                    
                                                    '</div>'+
                                                    '<div class="card-action">'+
                                                        '<a id="'+row.ID+'" class="spendContract">Spend</a>'+
                                                    '</div>'+
                                                '</div>'+
                                            '</li>';
                                    
                                    $('#contract-details').append(markup);
                                } else {
                                    M.toast({html: "Waiting for network to process this transaction..."});
                                    $('#contract').removeClass('hide');
                                    $('#contract-details').addClass('hide');
                                }
                            });
                            
                        }
                    });

                });
                $(document).on('click', '.backContract', function() {
                    $('#contract-details').empty();
                    $('#contract').removeClass('hide');
                });
                $(document).on('click', '.spendContract', function(){
                    let id = $(this).attr('id');

                    if ($('.contract-spend').length > 0) {
                        $('.contract-spend').remove();
                    }

                    $('.spendContract').replaceWith('<a id="'+id+'" class="createTransaction">Create</a>');

                    
                    // For spending transaction...
                    let amount = 0;
                    let recipAddress = "";

                    let markup = 
                                '<ul class="collection with-header contract-spend">'+
                                    '<li class="collection-header"> TXN Details </li>'+
                                    '<li class="collection-item input-field">'+
                                        '<input id="recipAddress" type="text" />'+ 
                                        '<label for="recipAddress">Recipient Wallet Address</label>'+
                                    '</li>'+
                                    '<li class="collection-item input-field">'+
                                        '<input id="spendAmount" type="number" />'+ 
                                        '<label for="spendAmount">Amount To Spend</label>'+
                                    '</li>'+
                                '<ul>';

                    $('.contract .details').after(markup)
                        
                });
                $(document).on('click', '.createTransaction', function(){
                    
                    let id = $(this).attr('id');
                    let amount = $('#spendAmount').val();
                    let recipAddress = $('#recipAddress').val();
                    let users = [];

                    // let's spend this transaction

                    Minima.sql('SELECT * FROM CONTRACTS WHERE ID='+id, function(res){
                        
                        let row = res.response.rows[0];
                        users = row.USERS;
                        keys = row.KEYS;
                        
                        Minima.cmd('coins relevant address:'+row.ADDRESS, function(res){
                            //input -> [id] [coinid] [position]
                            //output -> [id] [amount] [address] [tokenID] (position)
                            
                            let coinid = res.response.coins[0].data.coin.coinid;
                            let scriptAddr = res.response.coins[0].data.coin.address;
                            let change = new Decimal(res.response.coins[0].data.coin.amount).minus(new Decimal(amount)).valueOf();

                            let txn = "";
                            if (change > 0) {
                                txn = 'txncreate '+id+';'+
                                'txninput '+id+' '+coinid+' '+'0;'+
                                'txnoutput '+id+' '+amount+' '+recipAddress+' '+'0x00'+' '+'0;'+
                                'txnoutput '+id+' '+change+' '+scriptAddr+' '+'0x00'+' '+'1';
                            } else {
                                txn = 'txncreate '+id+';'+
                                'txninput '+id+' '+coinid+' '+'0;'+
                                'txnoutput '+id+' '+amount+' '+recipAddress+' '+'0x00'+' '+'0';
                            }

                            Minima.cmd(txn, function(res){
                                
                                if (Minima.util.checkAllResponses(res)){

                                    Minima.cmd('txnexport '+id, function(res) {

                                        let exportedTXN = res.response.transaction;

                                        let markup = 
                                        '<ul class="collection with-header contract-exp">'+
                                            '<li class="collection-header"> TXN Export </li>'+
                                            '<li class="collection-item input-field">'+
                                                '<input id="exportTXN" type="text" disabled value="'+exportedTXN+'" />'+ 
                                                '<label class="active" for="exportTXN">Exported Transaction</label>'+
                                            '</li>'+    
                                        '<ul>'+
                                        '<div class="row">'+
                                            '<div class="col s12">'+
                                                '<a id="copyExportBtn" class="btn-flat waves-effect waves-light waves-block polyBtn">Copy Package</a>'+
                                            '</div>'+
                                        '</div>';

                                        M.updateTextFields();

                                        $('.contract-spend:last-child').replaceWith(markup);

                                        $('.createTransaction').replaceWith('<a id="'+id+'" class="hide postTransaction">Post</a>');
                                
                                        $(document).on('click', '#copyExportBtn', function() {
                                            // creating json package
                                            let data = {
                                                id: "",
                                                type: "",
                                                message: "",
                                                keys: [],
                                                users: [],
                                                hexaddress: "",
                                                amount: 0,
                                                recipAddress: "",
                                                txn: ""
                                            }

                                            data.type = "toSign";
                                            data.message = "You are about to sign a transaction, are you sure?";
                                            data.keys = keys;
                                            data.id = id;
                                            data.hexaddress = scriptAddr;
                                            data.amount = amount;
                                            data.recipAddress = recipAddress;
                                            data.users = users;
                                            data.txn = exportedTXN;

                                            data = JSON.stringify(data);
                                            data = btoa(data);
                                            copyBase64(data);


                                            let markup =
                                            '<ul class="collection with-header contract-imp">'+
                                                '<li class="collection-header" style="font-size:1.2rem !important;"> After your participant(s) have signed.. let us import, add our public key and post! </li>'+
                                                '<li class="collection-item input-field">'+
                                                    '<input id="importTXN" type="text"/>'+ 
                                                    '<label class="" for="importTXN">Import the final transaction</label>'+
                                                '</li>'+
                                                '<li class="collection-item input-field">'+
                                                    '<input id="userKey" type="text"/>'+ 
                                                    '<label class="" for="userKey">Insert your public key</label>'+
                                                '</li>'+        
                                            '<ul>';

                                            $('.postTransaction').removeClass('hide');

                                            $('.contract-exp:last-child').replaceWith(markup);

                                        });


                                    });

                                }

                            });





                        }); 


                    });
                });
                // Post Transaction
                $(document).on('click', '.postTransaction', function(){
                    // Importing Package... 
                    let finalPkg = $('#importTXN').val();
                    // Get key
                    let key = $('.contract-imp #userKey').val();
                    // UX post
                    let markup = 
                    '<ul class="collection with-header contract-posted">'+
                        '<li class="collection-header" style="font-size:1.2rem !important;"> Posting... </li>'+
                    '<ul>';
                    $('.contract-imp').replaceWith(markup);
                    // hide post btn
                    $('.postTransaction').addClass('hide');
                    // convert base64 to string
                    let data = atob(finalPkg);

                    // parse string
                    if (JSON.parse(data)) {
                        data = JSON.parse(data);

                        // create the transaction
                        const txn = 
                                    'txnimport '+data.id+' '+data.txn+';'+
                                    'txnsign '+data.id+' '+key+';'+
                                    'txnpost '+data.id+' '+';'+
                                    'txndelete '+data.id;
                        // do the posting txn
                        Minima.cmd(txn, function(res){

                            if (Minima.util.checkAllResponses(res)){  
                                M.toast({html: "You have signed and posted this transaction successfully!", classes: "success"});

                                let markup = '<ul class="collection with-header"><li class="collection-header">Posted!</li></ul>';
                                $('.contract-imp').replaceWith(markup);

                                $('.contract-imp').remove();
                            } 
                        });
                                    

                        
                       

                    }



                
                });
                // Toggle on/off
                $(document).on('click', '#deleteForeverBtn', function(){
                    $('#contracts #contract').children().toggleClass('hideDeleteForever');
                });
                // delete contract row
                $(document).on('click', '#deleteForever', function(){


                    let confirmed = false;
                    let id = $(this).parent().parent().attr('id');

                    $('#dd-editModal').modal({
                        dismissible: false,
                        opacity: 0.2,
                        onOpenStart: function() {
                            $('#dd-editModal .modal-content > h4').html("You will <span style='font-weight:bold'>stop</span> tracking this contract, are you sure?");
                            $('#dd-editModal .modal-content > p').html("Contract with ID: "+id);
                            $('#dd-editModal #confirm').on('click', function(){
                                confirmed = true;
                            });
                        },
                        onCloseEnd: function() {
                            if(confirmed) {
                                Minima.sql('DELETE FROM CONTRACTS WHERE ID='+id, function(res){
                                    
                                    if(res.status){
                                        confirmed = false;
                                        $('#contracts #contract').addClass('hide');
                                        $('#contracts #contract').removeClass('hide');

                                    }
                                });
                            }
                        }
                    });

                    $('#dd-editModal').modal('open');
                    
                    
                    

                });
                $(document).on('click', '#dd-editBtn', function(){
                    $('.dropdown-trigger').dropdown();
                    
                    $('.dropdown-trigger').dropdown('open');
                });

                $(document).on('click', '#backToContracts', function(){
                    $('#contract-details').empty();
                    $('#contract').removeClass("hide");
                    $('#contract-details').addClass("hide");
                })
                
                
                
                /** TOOLS */
                $('#tools').on('click', function() {

                    $('#toolsMenu').toggleClass('active');
                    
                    if ($('#toolsMenu').hasClass('active')) {
                        $('#tools').text("Hide Tools");
                    } else {
                        $('#tools').text("Tools");

                    }

                });
                $('#toolsClose').on('click', function(){
                    
                    $('#toolsMenu').toggleClass('active');
                    
                    if ($('#toolsMenu').hasClass("active")) {
                        $('#tools').text("Hide Tools");
                    } else {
                        $('#tools').text("Tools");
                    }
                    
                    
                });

                $(document).on('click', '#copyCoin', function(){
                    
                    var id = $('#pubKey').val();

                    if (id.length > 0) {
                        const el = document.createElement('textarea');
                        el.value = id.substring(0, id.length-12);
                        document.body.appendChild(el);
                        el.select();
                        document.execCommand('copy');
                        document.body.removeChild(el);
    
                        /* Alert the copied text */
                        M.toast({html: "Copied to clipboard.", classes: "success"});
                    } else {
                        M.toast({html: "Nothing to copy."});

                    }

                    return false;

                    
                });
                $('#genBtn').on('click', function(){
                    
                    if ($('#generateTool').hasClass('hide') && !$('#importDataTool').hasClass('hide')) {
                        $('#importDataTool').addClass('hide');
                        $('#generateTool').removeClass('hide');
                    } else {
                        $('#generateTool').removeClass('hide');
                    }
                });

                $('#newKey').on('click', function(){

                    Minima.cmd('keys new', function(res){

                        if (res.status) {

                            $('#pubKey').val(res.response.key.publickey);

                            M.updateTextFields();

                        }

                    }); 

                });
                $(document).on('click', '#genClose', function() {
                    $('#generateTool').addClass("hide");
                })
                
                // IMPORT PACKAGES TOOL
                $('#importDataBtn').on('click', function() {
                    
                    if (!$('#generateTool').hasClass('hide')) {
                        $('#importDataTool').removeClass('hide');
                        $('#generateTool').addClass('hide');
                    } else {
                        $('#importDataTool').removeClass('hide');

                    }

                    if ($('#importDataTool > :last-child').length == 0) {
                        // if other tools open.. get rid of them
                        if ($('#generateTool').length > 0) {
                            $('#generateTool').addClass('hide');
                        }
                    

                        let markup = 
                                    '<div class="row">'+
                                        '<div class="col s12">'+
                                            '<span><a id="impDataClose" class="left exit">&#10005;</a></span>'+
                                        '</div>'+
                                    '</div>'+
                                    '<div class="row">'+
                                        '<div class="input-field col s12">'+
                                            '<input id="importData" type="text">'+
                                            '<label for="importData">Insert your import data here...</label>'+
                                        '</div>'+
                                    '</div>'+
                                    '<div class="row">'+
                                        '<div class="col s12">'+
                                            '<div id="importPkgBtn" class="modal-trigger btn-flat waves-effect waves-light waves-block polyBtn" data-target="toScriptModal">Import Data Package</div>'+
                                            '<div id="clearImport" class="btn-flat waves-effect waves-light waves-block">Clear</div>'+
                                        '</div>'+
                                    '</div>';
                        // Add input form
                        $('#importDataTool').append(markup);
                    }
                });
                $(document).on('click', '#impDataClose', function(){
                    $('#importDataTool').addClass('hide');
                    $('#importDataTool').empty();
                });
                $(document).on('click', '#importPkgBtn', function(){
                    
                    let data = $('#importData').val();
                    let isConfirmed = false;
                    // check transaction type
                    if (data.length > 0) {

                        data = atob(data);

                        if (JSON.parse(data)) {
                            data = JSON.parse(data);

                            if(data.type == "toScript") {
                                $('#toScriptModal').modal({
                                    dismissible: false,
                                    opacity: 0.2,
                                    onOpenStart: function(){
                                            
                                        $('#toScriptModal > .modal-content > h4').html("You are about to import a <span style='font-weight:600;'>Script Address</span>, are you sure?");
                                        $('#toScriptModal #users').text(data.users);
                                        $('#toScriptModal #scriptAddr').text(data.hexaddress);
                                        $('#toScriptModal #signees').text(data.keys);

                                        $('#impConfirmBtn').on('click', function(){

                                            isConfirmed = true;

                                        });
                                        
                                    },
                                    onCloseEnd: function() {
                                        
                                        if(isConfirmed) {
                                            Minima.cmd('newscript '+data.hexaddress, function(res){
                                                if (res.status) {

                                                    let users = JSON.stringify(input.users);
                                                    let keys = JSON.stringify(input.keys);
                                                    let date = Date.now().toString();
                                                    let type = "This is a "+input.min+"/"+input.signees+" MultiSig Contract";

                                                    const INSERT = "INSERT INTO CONTRACTS VALUES ('";
                                                    console.log(data);
                                                    console.log(data.id);
                                                    Minima.sql(INSERT+data.id+"', '"+data.hexaddress+"', '"+date+"', '"+keys+"', '"+users+"', '"+type+"')", function(response){
                                                        console.log(response);
                                                        if (response.status) {
                                                            M.toast({html: "You are now tracking this contract.  You can find it in your contracts!", classes: "success"});
                                                            isConfirmed = false;
                                                        }
                                                    });
                                                }
                                            });
                                        }
                                    }
                                });
                                // open when ready
                                $('#toScriptModal').modal('open');
                            } else if (data.type == "toSign") {
                                $('#toSignModal').modal({
                                    dismissible: false,
                                    opacity: 0.2,
                                    onOpenStart: function(){
                                        console.log(data);
                                        $('#toSignModal > .modal-content > h4').html("You are about to sign a <span style='font-weight:600;'>Contract Transaction</span>, are you sure?");
                                        $('#toSignModal #users').text(JSON.parse(data.users));
                                        $('#toSignModal #scriptAddr').text(data.hexaddress);
                                        $('#toSignModal #usersKeys').text(JSON.parse(data.keys));
                                        $('#toSignModal #spend').text(data.amount);
                                        $('#toSignModal #recipAddr').text(data.recipAddress);

                                        $('#impSignBtn').on('click', function(){

                                            isConfirmed = true;

                                        });
                                        
                                    },
                                    onCloseEnd: function() {
                                        
                                        if(isConfirmed) {

                                            let key = $('#toSignModal #userKey').val();

                                            Minima.cmd('txnimport '+data.id+' '+data.txn+';'+'txnsign '+data.id+' '+key+';'+'txnexport '+data.id, function(res){
                                                
                                                if (Minima.util.checkAllResponses(res)){

                                                    data.txn = res[2].response.transaction;
                
                                                    data = JSON.stringify(data);
                                                    data = btoa(data);
                                                    copyBase64(data);
                                                    isConfirmed = false;
                                                    M.toast({html: "Signed and package copied to your clipboard!"});
                                                    

                                                    
                                                } else {
                                                    M.toast({html: "Something went wrong!"});
                                                }

                                            });

                                            $('#userKey').val('');

                                           
                                        }
                                    }
                                });
                                // open when ready
                                $('#toSignModal').modal('open');
                            }
                        }
                        
                    } else {
                        M.toast({html: "Empty input data..."});
                    }


                });
                $(document).on('click', '#clearImport', function(){

                    $('#importData').val('');

                });
                
                setTimeout(() => {
                    menu.classList.add("scale-in");
                    createBtn.classList.add("scale-in");
                    provideBtn.classList.add("scale-in");
                }, 300);
            });
        </script>

        <!-- Tutorial Overlay -->
        <div id="tutorial" class="carousel carousel-slider hide">
            <div id="first" class="carousel-item carousel-fixed-item" href="#one!">
                <span><a id="tutorialClose" class="right exit">&#10005;</a></span>
                <!-- helper div to fix valign issues -->
                <div class="row" style="position: relative; top:5%">
                    <div class="empty" style="height:35px;"></div>
                </div>
                <div class="row valign-wrapper">
                    <div class="col s12 center-align">
                        <h4>
                            <span id="brand" style="font-size: 2.5rem;">PolySig</span>
                        </h4>
                    </div>
                </div>
                <div class="row valign-wrapper">
                    <div class="col s12 center-align">
                        <img style="width: 180px;" src="assets/polysig.png" alt="logo">
                    </div>
                </div>
                
                <div class="row valign-wrapper">
                    <div class="col s12 center-align">
                        <h4>Welcome!</h4>
                        <p>Let's get started with a quick tutorial.</p>
                    </div>  
                </div>
                <div class="row valign-wrapper">
                    <div class="col s12 center-align">
                        <i id="carouselNext1" class="material-icons next">arrow_forward</i>
                    </div>
                </div>
            </div>
            <div id="second" class="carousel-item carousel-fixed-item" href="#two!">
                <span><a id="tutorialClose2" class="right exit">&#10005;</a></span>
                <!-- helper div to fix valign issues -->
                <div class="row" style="position: relative; top:5%">
                    <div class="empty" style="height:35px;"></div>
                </div>
                <div class="row valign-wrapper">
                    <div class="col s12 center-align">
                        <h4>
                            <span id="brand" style="font-size: 2.5rem;">PolySig</span>
                        </h4>
                    </div>
                </div>
                <div class="row valign-wrapper">
                    <div class="col s12 center-align">
                        <img style="width: 180px;" src="assets/coin.svg" alt="logo">
                    </div>
                </div>
                
                <div class="row valign-wrapper">
                    <div class="col s12 center-align">
                        <h4>Transactions</h4>
                        <p>Minima transactions are made up of inputs and outputs, where <span style="font-weight: bold;">coins</span> are inputs, and the output is the <span style="font-weight: bold">script address.</span></p>
                    </div>  
                </div>
                <div class="row valign-wrapper">
                    <div class="col s12 center-align">
                        <i class="material-icons next">arrow_forward</i>
                    </div>
                </div>
            </div>
            <div id="third" class="carousel-item carousel-fixed-item" href="#three!">
                <span><a id="tutorialClose3" class="right exit">&#10005;</a></span>
                <!-- helper div to fix valign issues -->
                <div class="row" style="position: relative; top:5%">
                    <div class="empty" style="height:35px;"></div>
                </div>
                <div class="row valign-wrapper">
                    <div class="col s12 center-align">
                        <h4>
                            <span id="brand" style="font-size: 2.5rem;">PolySig</span>
                        </h4>
                    </div>
                </div>
                <div class="row valign-wrapper">
                    <div class="col s12 center-align">
                        <img style="width: 180px;" src="assets/slot-machine.svg" alt="logo">
                    </div>
                </div>
                
                <div class="row valign-wrapper">
                    <div class="col s12 center-align">
                        <h4>MultiSig Contracts</h4>
                        <p>To spend a coin, the rightful owner must sign the transaction before posting it to the network.</p>
                        
                        <p>
                            Inputting these coins as input then outputting them to a newer transaction/contract, 
                            signed by 
                            <span style="font-weight:bold; font-style:italic">2(+)</span> out of 
                            <span style="font-weight:bold; font-style:italic">n</span> signatures,
                            will then make it only possible to be spent by the minimum needed signatures <span style="font-weight:bold">you</span> define in the transaction before.
                        </p>
                        

                    </div>  
                </div>
                <div class="row valign-wrapper">
                    <div class="col s12 center-align">
                        <i class="material-icons next">arrow_forward</i>
                    </div>
                </div>
            </div>
            <div id="fourth" class="carousel-item carousel-fixed-item" href="#four!">
                <span><a id="tutorialClose4" class="right exit">&#10005;</a></span>
                <!-- helper div to fix valign issues -->
                <div class="row" style="position: relative; top:5%">
                    <div class="empty" style="height:35px;"></div>
                </div>
                <div class="row valign-wrapper">
                    <div class="col s12 center-align">
                        <h4>
                            <span id="brand" style="font-size: 2.5rem;">PolySig</span>
                        </h4>
                    </div>
                </div>
                <div class="row valign-wrapper">
                    <div class="col s12 center-align">
                        <img style="width: 180px;" src="assets/rocket-ship.svg" alt="logo">
                    </div>
                </div>
                
                <div class="row valign-wrapper">
                    <div class="col s12 center-align">
                        <h4>Get Started!</h4>
                        <p>Let's create our very first contract!</p>
                    </div>  
                </div>
                <div class="row valign-wrapper">
                    <div class="col s12 center-align">
                        <a id="tutorialBtn" class="btn-flat waves-light waves-effect">Let's go.</a>
                    </div>
                </div>
            </div>
        </div>
        <a id="tools" class="btn-flat btn waves-effect waves-light waves-block">
            Tools
        </a>
        
        <div id="logo" class="row center-align no-padding">
            <div id="start-menu-title" class="start-menu col s12">
                <h1 id="brand">PolySig</h1>
            </div>
        </div>

        <div id="toolsMenu" class="center-align">
            <div class="row toolButtons">
                <div class="col s12">
                    <h2>Tools <a id="toolsClose" class="right exit">&#10005;</a></h2>
                </div>
            </div>
            <div class="row toolButtons">
                <div class="col s12">
                    <a id="genBtn" class="waves-effect waves-light btn waves-block">Generate Key</a> 
                </div>
                <div class="col s12">
                    <a id="importDataBtn" class="waves-effect waves-light btn waves-block">Import Data Packages</a>    
                </div>
            </div>
            <div id="generateTool" class="section hide">
                <div class="row exitWrapper">
                    <div class="col s2">
                        <span><a id="genClose" class="left exit">&#10005;</a></span>
                    </div>
                </div>
                <div class="row">
                    <div class="col s12">
                        <a id="newKey" class="btn-flat waves-light waves-effect polyBtn">Generate Key</a>
                    </div>
                </div>
                <div class="row">
                    <div class="col s12 input-field">
                        <input type="text" disabled id="pubKey" class="center-align">
                        <label for"pubKey">New Public Key</label>
                    </div>
                </div>
                <div class="row">
                    <div class="col s12">
                        <a id="copyCoin" class="btn-flat waves-effect waves-block waves-light polyBtn">Copy</a>
                    </div>
                </div>
            </div>
            <div id="importDataTool" class="section hide">
   
            </div>
        </div>
        
        <div id="mainMenu" class="valign-wrapper">
            <!-- Main -->
            <div id="s-menu" class="center-align" style="width: 100%;">
                <div class="row center-align">
                    <div id="btnWrap1" class="col s6 offset-s3 scale-transition scale-out">
                        <a id="createBtn" class="btn-flat waves-block waves-effect waves-light polyBtn">
                            Create
                        </a>
                    </div>
                </div>
                <div class="row center-align">
                    <div id="btnWrap2" class="col s6 offset-s3 scale-transition scale-out">
                        <div id="provideBtn" class="btn-flat waves-block waves-effect waves-light polyBtn">
                            Contracts
                        </div>
                    </div>
                </div>
            </div>
            <!-- Create -->
            <div id="s-create" class="container" style="display: none;">
                <div class="row">
                    <div class="row right" style="position: absolute; right: 3px; top:10px;">
                        <div class="col s12">
                            <div id="homeBtn2" class="btn-flat waves-effect waves-light backBtn" style="vertical-align: middle">
                                <i id="forward" class="material-icons left no-padding">arrow_back</i>
                            </div>
                        </div>
                    </div>
                    <div id="create-menu-title" class="col s-12">
                        <h1>
                            <i id="info" class="tiny material-icons" style="margin: 0;">info</i> Let's choose how many participant(s) we want in this contract.
                        </h1>
                    </div>
                </div>
                <div id="signee" class="row">
                    <div class="input-field col s12 m6">
                        <i class="material-icons prefix">lock</i>
                        <input id="users" type="number" class="validate">
                        <label for="users">No. of Signee</label>
                    </div>
                    <div class="input-field col s12 m6">
                        <i class="material-icons prefix">lock_open</i>
                        <input id="minimum" type="number" class="validate">
                        <label for="minimum">Minimum signatures</label>
                    </div>
                </div>
                <div class="row">
                    <div class="col s10 offset-s1 center-align">
                        <a id="proceedBtn" class="btn-flat waves-effect waves-light modal-trigger polyBtn" href="#modalCreate">
                            <i id="forward" class="material-icons right no-padding">arrow_forward</i>Proceed
                        </a>
                    </div>
                </div>
               
            </div>
            <!-- Stage 1 -->
            <div id="s-stage1" class="container hide">
                <div class="row center-align">
                    <div class="row right" style="position: absolute; right: 3px; top:10px;">
                        <div class="col s12">
                            <div id="homeBtn3" class="btn-flat waves-effect waves-light backBtn" style="vertical-align: middle">
                                <i id="forward" class="material-icons left no-padding">arrow_back</i>
                            </div>
                        </div>
                    </div>
                    <div id="create-menu-title" class="col s-12">
                        <h1>
                            <i id="info" class="tiny material-icons" style="margin: 0;">info</i> Fill out your and your participant(s) details.
                        </h1>
                    </div>
                </div>
                <div class="row center-align">
                    <div id="participants" class="col s12">
                        <ul class="collection">
                            
                        </ul>
                    </div>
                </div>
                <div class="row">
                    <div class="col s10 offset-s1 center-align">
                        <a id="proceedBtnStage1" class="btn-flat waves-effect waves-light polyBtn">
                            <i id="forward" class="material-icons right no-padding">arrow_forward</i>Proceed
                        </a>
                    </div>
                </div>
            </div>
            <!-- Stage 1 - 2 -->
            <div id="s-stage1-2" class="container hide center-align">
                <div class="row center-align">
                    <div id="create-menu-title" class="col s-12">
                        <h1>
                            <i id="info" class="tiny material-icons" style="margin: 0;">info</i> This is your multi-signature address, Share this with your participant(s) so they can track this contract with you.
                        </h1>
                    </div>
                </div>
                <div class="row">
                    <div id="multiSigScript" class="col s12">
                        
                    </div>
                </div>

                <div id="copyPackageWrapper" class="row center-align hide">
                    <div class='col s12'>
                        <a id='copyAddress' class='btn-flat waves-effect waves-light polyBtn'>Copy Package</a>
                    </div>
                </div>
                <div id="continueBtnWrapper" class="hide row center-align">
                    <div class="col s12">
                        <a id="endStageBtn1" class="btn-flat waves-effect waves-light polyBtn">Continue</a>
                    </div>
                </div>
                <div id="postContractWrapper" class="hide row center-align">
                    <div>
                        <a id="postBtn" class="btn-flat waves-effect waves-light polyBtn">Post Contract</a>    
                    </div>
                </div>

                <div class="row center-align">
                    <div class="col s12 center-align">
                        <a id="homeBtn4" class="btn-flat waves-effect waves-light backBtn" style="vertical-align: middle">
                            <i id="forward" class="material-icons left no-padding">arrow_back</i>
                        </a>
                    </div>
                </div>
            </div>
            <!-- Posted  -->
            <div id="s-contracts" class="container hide center-align">
                <div class="row">
                    <div class="col s12">
                        <div id="contracts">
                            <ul class="collection with-header">
                                <li class="collection-header">Contract Activities</li>
                                <div id="contract">

                                </div>
                                <div id="contract-details" class="hide">
                                    
                                </div>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="row center-align">
                    <div class="col s12">
                        <div id="homeBtn5" class="btn-flat waves-effect waves-light backBtn" style="vertical-align: middle">
                            <i id="forward" class="material-icons left no-padding">arrow_back</i>
                        </div>
                    </div>
                </div>
            </div>
            
        
    </div>

    <!-- Confirm Signee Modal -->
    <div id="modalCreate" class="modal">
        <div class="modal-content">
            <h4 id="m-contractHeader"></h4>
            <p id="m-contractType"></p>
        </div>
        <div class="modal-footer">
            <a class="modal-action modal-close waves-effect waves-red btn-flat ">Cancel</a>
            <a id="confirm" class="hide modal-action modal-close waves-effect waves-green btn-flat">Confirm</a>
        </div>
    </div>
    <!-- Modal For toScript -->
    <div id="toScriptModal" class="modal bottom-sheet">
        <div class="modal-content">
            <h4></h4>
            <div class="row">
                <div class="col s12">
                    <ul class="collection with-header">
                        <li class="collection-header">Import Details</li>
                        <li class="collection-item">
                            <div>PARTICIPATING USERS<a id="users" class="secondary-content"> </a></div>
                        </li>
                        <li class="collection-item">
                            <div>SCRIPT ADDRESS<a id="scriptAddr" class="secondary-content"> </a></div>
                        </li>
                        <li class="collection-item">
                            <div>SIGNEES<a id="signees" class="secondary-content"> </a></div>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="modal-footer">
            <div class="modal-close waves-effect waves-green btn-flat">Cancel</div>
            <div id="impConfirmBtn" class="modal-close waves-effect waves-green btn-flat">Add</div>
        </div>
    </div>
    <!-- Modal For toSign -->
    <div id="toSignModal" class="modal bottom-sheet">
        <div class="modal-content">
            <h4></h4>
            <div class="row">
                <div class="col s12">
                    <ul class="collection with-header">
                        <li class="collection-header">Import Details</li>
                        <li class="collection-item">
                            <div>PARTICIPATING USERS<a id="users" class="secondary-content"> </a></div>
                        </li>
                        <li class="collection-item">
                            <div>USERS KEYS<a id="usersKeys" class="secondary-content"> </a></div>                            
                        </li>
                        <li class="collection-item">
                            <div>SCRIPT ADDRESS<a id="scriptAddr" class="secondary-content"> </a></div>
                        </li>
                        <li class="collection-item">
                            <div>WANTS TO SPEND<a id="spend" class="secondary-content"> </a></div>
                        </li>
                        <li class="collection-item">
                            <div>RECIPIENT ADDRESS<a id="recipAddr" class="secondary-content"></a></div>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="row">
                <div class="col s12 input-field">
                    <input id="userKey" type="text">
                    <label for="userKey">Insert your public key here...</label>
                </div>
            </div>
        </div>
        <div class="modal-footer">
            <div class="modal-close waves-effect waves-green btn-flat">Cancel</div>
            <div id="impSignBtn" class="modal-close waves-effect waves-green btn-flat">Sign</div>
        </div>
    </div>
    <!-- dd-edit -->
    <ul id='dd-edit' class='dropdown-content'>
        <li id="deleteForeverBtn"><a href="#!"><i class="material-icons">delete_forever</i>Toggle</a></li>
    </ul>
    <!-- dd-edit-deleteModal -->
    <div id="dd-editModal" class="modal">
        <div class="modal-content">
            <h4></h4>
            <p></p>
        </div>
        <div class="modal-footer">
            <a class="modal-action modal-close waves-effect waves-red btn-flat ">Cancel</a>
            <a id="confirm" class="modal-action modal-close waves-effect waves-green btn-flat">Confirm</a>
        </div>
    </div>

        <script src="js/minima.js" type="text/javascript"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js" integrity="sha512-qTXRIMyZIFb8iQcfjXWCO8+M5Tbc38Qi5WzdPOYZHIlZpzBHG3L3by84BBBOiRGiEb7KKtAOAs5qYdUiZiQNNQ==" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/decimal.js/9.0.0/decimal.min.js" integrity="sha512-zPQm8HS4Phjo9pUbbk+HPH3rSWu5H03NFvBpPf6D9EU2xasj0ZxhYAc/lvv/HVDWMSE1Autj19i6nZOfiVQbFQ==" crossorigin="anonymous"></script>

    </body>
</html>